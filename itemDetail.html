<html>
	<head>
  
    <title>LeapMoShop - Item details</title>
    
		<link href="itemList.css" rel="stylesheet">
		<link href="shopStyle.css" rel="stylesheet">
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
		<script src="//js.leapmotion.com/0.2.2/leap.min.js"></script>
		<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

		<script src="./js/loader.js"> </script>
    <script src="./js/uiRender.js"></script>
		<script src="./js/leap_src/leap_action.js"></script>
		<script src="./js/leap_src/leap_ui.js"></script>
		<script src="./js/leap_src/leap_action_definition.js"></script>
		
<script>


function QueryString(name) 
{
  var AllVars = window.location.search.substring(1);
  var Vars = AllVars.split("&");
  for (i = 0; i < Vars.length; i++)
  {
    var Var = Vars[i].split("=");
    if (Var[0] == name) return Var[1];
  }
  return "";
}

var category = QueryString("category").toLowerCase();
var item_id = QueryString("id");

item_id = parseInt(item_id);

//console.log("category = " + category);
//console.log("item_id = " + item_id);

var xmlFileName = "";

switch(category){
  case "trousers": xmlFileName = "info_trousers.xml";break;
  case "socks": xmlFileName = "info_legwear.xml";break;
  case "shoes": xmlFileName = "info_shoes.xml";break;
  case "clothes": xmlFileName = "info_clothing.xml";
  default: xmlFileName = "info_clothing.xml";
}
xmlFileName = "./xml/" + xmlFileName;

$(document).ready(function () {
  $.ajax({
    type: "GET",
    url: xmlFileName,
    cache: false,
    dataType: "xml",
    success: function(xml) {
      $(xml).find('item:eq('+ item_id +')').each(function(){
        var _this = $(this);
        //console.log(_this.html());
        //console.log(_this.find("name").text());
        //console.log(_this.find("desc").text());
        //console.log(_this.find("imageName").text());
        //console.log(_this.find("price").text());
        //console.log(_this.find("rate").text());
        
        $(".header").html(_this.find("name").text());
        $(".description").html(_this.find("desc").text());
        $(".itemPrice").html(_this.find("price").text());
        $(".header").html(_this.find("name").text());
        $(".rating").html(_this.find("rate").text());
        
        $(".image").attr("src", "./shopItemImage/" + _this.find("imageName").text());
        
      });
    }
  });
});




</script>
<style>
body{text-align:center;}
.bodyWidth{
  width:900px;margin:10px auto;border:1px solid #ddd;background-color:#fff;min-height:500px;
  text-align:left;
}

div.header{
  font-size:1.5em;padding:18px;padding-top:30px;border-bottom:1px solid #ddd;
  background-color:#fbfbfb;
}

div.content{
  text-align:left;
  max-width:650px;
}
.priceDiv, .ratingsDiv{
  display:inline-block;font-size:1.3em;padding:10px 20px;color:#29851b;
}

div.sectionTitle{border-bottom:1px solid #ddd;padding:5px 8px;margin-top:12px;}
div.sectionTitle span{
  border:1px solid #ddd;border-bottom:none;padding:6px 8px;
  background-color:#FFFBE2;
}
div.description{padding:20px;max-width:640px;}


.right_div{float:right;}
img.image{
  padding:4px;
  border:1px solid #ddd;width:220px;
  background-color:#fff;margin-right:14px;margin-top:14px;
}
img.image:hover{border:1px solid #555;}


.buyNowStyle, .addToCartStyle, .closeBox{
  padding:12px;font-size:1.2em;text-align:center;margin:2px 0;width:206px;
  cursor:pointer;color:#fff;margin-top:5px;
}
.buyNowStyle{background-color:#2d29a3;}
.addToCartStyle{background-color:#ff9d00;}
.buyNowStyle:hover{background-color:#7491f7;}
.addToCartStyle:hover{background-color:#ffc77d;}

.commentContainer{margin-left:4px;margin-bottom:4px;}
.commentItem{border:1px solid #ddd;margin-top:4px;margin-left:4px;}

.commentInfo{padding:4px 8px;color:#555;border-bottom:1px solid #ddd;background-color:#fffae8;}
span.commentDatetime{float:right;}
.commentContent{padding:4px 8px;min-height:50px;}
textarea.commentTextarea{width:100%;max-width:100%;height:60px;}

.popupContainer{
  position:fixed;top:0;left:0;width:100%;height:100%;
  text-align:center;background-color:rgba(255,255,255,0.5);
}
.popupBox{
  position:fixed;top:50%;left:50%;
  width:500px;height:400px;border:1px solid #ddd;background-color:#fff;
  margin-top:-200px;margin-left:-250px;
}

.popupShippingInfo{text-align:left;margin:10px 14px;margin-top:20px;}
.popupShippingInfo span{display:inline-block;cursor:pointer;margin-left:20px;color:#2c6ade;}
.popupShippingInfo span:hover{color:#f77f57;}

.popupButtonDiv div{display:inline-block;margin:8px;}
.closeBox{background-color:#F8F8F8;border:1px solid #ddd;color:#222;}
.closeBox:hover{background-color:#fbfbfb;}

.popupInfoDiv{padding-top:30px;}
div.quantityInputDiv{margin:10px;}
.quantityInput{font-size:3em;width:120px;border:2px solid #CA0000;text-align:center;}
div.popupInfoHeader{color:#000;font-size:1.3em;margin:10px;}
div.popupInfoTip{color:#777;font-size:1em;margin:10px;}

.popupShippingInfoTextarea{display:none;}
.popupShippingInfoTextarea textarea{width:100%;height:80px;}

.popupItemCounterDiv{margin:14px;}
span.itemCounter{
  border:1px solid #ddd;
  background-color:#fbfbfb;
  font-size:3.3em;
  padding:10px 20px;
  display:inline-block;
}
span.pcs{display:inline-block;font-size:1.3em;margin-left:10px;}
</style>

</head>
<body>
		
<div class="bodyWidth">

  <div class="right_div">
    <img class="image" src="" />
    
    <div class="buyNowStyle buyNow pointable">Buy Now</div>
    <div class="addToCartStyle addToCart pointable">Add to Cart</div>
  </div>

  <!-- The item name -->
  <div class="header"></div>

  <div class="content">

    <div class="priceDiv">Price: HK$ <span class="itemPrice"></span></div>
    <div class="ratingsDiv">Ratings: <span class="rating"></span> / 5.0</div>



    <div class="sectionTitle"><span>Description</span></div>
    <div class="description"></div>


    <div class="sectionTitle"><span>User Comments</span></div>
    <div class="commentContainer">
    
      <div class="commentItem">
        <div class="commentInfo">
          Comment 1, posted by KIN
          <span class="commentDatetime">5:19, 31 March, 2014</span>
        </div>
        <div class="commentContent">
          This item is excellent! I strongly recommend it! Buy it immediately!
        </div>
      </div>
    
      <div class="commentItem">
        <div class="commentInfo">
          Comment 2, posted by ALEX
          <span class="commentDatetime">16:32, 6 April, 2014</span>
        </div>
        <div class="commentContent">
          I like this item very much!
        </div>
      </div>
      
      <div class="commentItem">
        <div class="commentInfo">
          Comment 3, posted by WILLIAM
          <span class="commentDatetime">19:01, 10 April, 2014</span>
        </div>
        <div class="commentContent">
          I like this item TOO!
        </div>
      </div>
      
      <div class="commentItem">
        <div class="commentInfo">
          Comment 4, posted by RICHARD
          <span class="commentDatetime">04:13, 12 April, 2014</span>
        </div>
        <div class="commentContent">
          I'm lov'in it! :)
        </div>
      </div>
      
      
      <div class="commentItem">
        <div class="commentInfo">
          Leave a comment
          
        </div>
        <div class="commentContent">
          <textarea class="commentTextarea" placeholder="Leave a comment here"></textarea>
          <input type="button" value="Submit Comment" style="padding:4px 8px;"/>
        </div>
      </div>
    
    </div>
  
  
  </div>
</div>



<div class="gradientBlue buttonLink hoverHighlight verticalAlignMiddle includeShadow backButton" >
  <div>
    &lt; Back
  </div>
</div>




<script>
__config.enable_finger = true;
var _showingPopup = false;

// validate a number input
// http://stackoverflow.com/questions/18082/validate-decimal-numbers-in-javascript-isnumeric
var isNumber = function(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
}



var showBox = function(type){
  
  var _toAdd = "";
  console.log(type);
  
  if(type=="buyNow"){
    _toAdd = "<div class='buyNowStyle buyNowPopup pointable'>Buy Now</div>";
  }else if(type=="addToCart"){
    _toAdd = "<div class='addToCartStyle addToCartPopup pointable'>Add to Cart</div>";
  }else{
    // error
    
  }
  
  var toAppend = "<div class='popupBox'>";
  
  toAppend += "<div class='popupInfoDiv'><div class='popupInfoHeader'>Please enter the quantity:</div><div class='quantityInputDiv'><input type='text' class='quantityInput pointable' /></div>";
  toAppend += "<div class='popupInfoTip'>Input with Leap Motion enabled (1-5 items only).<br/>Use \"0 Finger\" to Cancel</div></div>";
  
  if(type=="buyNow"){
    toAppend += "<div class='popupShippingInfo'><div>Use your default Shipping Address. <span class='changeAddr'>Change</span></div>";
    toAppend += "<div class='popupShippingInfoTextarea'><textarea>Flat 1, \nSilent Hill 1-2-3-4, \nCabin Woods, \nDistrict 9</textarea></div></div>";
  }
  
  toAppend += "<div class='popupButtonDiv'><div class='closeBox pointable'>Cancel</div>" + _toAdd + "</div>";
  toAppend += "</div>";
  
  $("<div class='popupContainer' style='display:none'></div>")
    .append(toAppend)
    .appendTo("body").show("drop");
    
  $(".quantityInput").focus().click(function(){$(this).select()});
  _showingPopup = true;
  
  if(type=="buyNow"){
    $(".changeAddr").click(function(){
      $(this).parent().siblings(".popupShippingInfoTextarea").toggle();
    });
  }
  
  
  $(".buyNowPopup").click(function(){
    var val = $(".quantityInput:visible").val();
    if(isNumber( val )){
      //closeBox();
      //alert("Submitted order with " + val + " item(s)!");
      $(".popupBox").remove();
      
      var toAppendNew = "<div class='popupBox'>";
      toAppendNew += "<div class='popupInfoDiv'><div class='popupInfoHeader'>Order submitted successfully!</div></div>";
      toAppendNew += "<div class='popupItemCounterDiv'>In this order:<br/><span class='itemCounter'>"+ val +"</span><span class='pcs'>pcs</span></div>";
      toAppendNew += "<div class='popupButtonDiv'><div class='done closeBox pointable'> Done </div><div class='viewOrder closeBox pointable'> View Order </div></div>";
      toAppendNew += "</div>";
      $(".popupContainer").append(toAppendNew);
      
      $(".done").click(function(){
        closeBox();
      });
      $(".viewOrder").click(function(){
        location.href = "./orderHistory.html";
      });
      
    }else{
      alert("Please input a number");
    }
  });
  
  $(".addToCartPopup").click(function(){
    var val = $(".quantityInput:visible").val();
    
    if(isNumber( val )){
      //closeBox();
      //alert("Added " + val + " item(s) to cart");
      $(".popupBox").remove();
      
      var toAppendNew = "<div class='popupBox'>";
      toAppendNew += "<div class='popupInfoDiv'><div class='popupInfoHeader'>Added the item(s) to cart successfully!</div></div>";
      toAppendNew += "<div class='popupItemCounterDiv'>In this order:<br/><span class='itemCounter'>"+ val +"</span><span class='pcs'>pcs</span></div>";
      toAppendNew += "<div class='popupButtonDiv'><div class='done closeBox pointable'> Done </div><div class='viewOrder closeBox pointable'> View Cart Items </div></div>";
      toAppendNew += "</div>";
      $(".popupContainer").append(toAppendNew);
      
      $(".done").click(function(){
        closeBox();
      });
      $(".viewOrder").click(function(){
        location.href = "./cartItem.html";
      });
      
    }else{
      alert("Please input a number");
    }
    
  });
  
  $(".closeBox").click(function(){
    closeBox();
  });
};

var closeBox = function(){
  $(".popupBox").hide("puff", {}, 1000);
  $(".popupContainer").fadeOut();
  _showingPopup = false;
};


$(".buyNow").click(function(){
  //alert("show");
  showBox("buyNow");
});

$(".addToCart").click(function(){
  showBox("addToCart");
});


</script>
</body>
</html>